<!DOCTYPE html>
<html>
<head>
    <title>Main</title>
    <link rel="stylesheet" type="text/css" href="css/capella.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
</head>
<body>
    <div name="js-capella-bg" class="capella-background" data-large="/public/app/img/Bitmap.png">
        <div class="capella">
            <div class="capella__contents">
                <div class="capella__logo"></div>
                <div class="capella__title">
                    <img src="public/app/img/Capella-branding.svg">
                </div>
                <p>Upload file directly, by drag-n-drop or from the Buffer. Then youâ€™ll get link to that.</p>
                <form method="post" action="/upload" enctype="multipart/form-data">
                    <label for="ImageFile" class="capella__button">Select picture</label>
                    <input id="ImageFile" type="file" name="file" hidden="true"/>
                    <input type="submit" value="Upload" hidden="true"/>
                </form>
                <form method="post" action="/upload" autocomplete="off">
                    <input class="capella__input" type="text" name="link" placeholder="Paste the URL"/>
                    <input type="submit" value="Upload" hidden="true"/>
                </form>
            </div>
        </div>
    </div>
    <script type="text/javascript">
window.onload = function() {
  
  var target = document.getElementsByName('js-capella-bg')[0];
  var body = document.querySelector("body");
  console.log('url(' + target.dataset.large +')');
  
  // // 1: load small image and show it
  // var img = new Image();
  // img.src = small.src;
  // img.onload = function () {
  //  small.classList.add('loaded');
  // };
  
  // 2: load large image
  loaded = false;
  var imgLarge = new Image();
  imgLarge.src = target.dataset.large; 
  imgLarge.onload = function () {
    loaded = true;
    body.style.backgroundImage = 'url(' + target.dataset.large +')';
    fallback(loaded);
  };

  var fallback = function(loaded) {setTimeout(function() {
    // if when the time has passed image.onload had already occurred, 
    // run success()
    if (loaded) {
      console.log('true')
      target.style.background = 'transparent';
    } else{
      console.log('err');
    }
  }, 1500);

}
}
    </script>
</body>
</html>
